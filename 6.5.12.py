"""
–ö–ª–∞—Å—Å WriteSpyüå∂Ô∏è
–†–µ–∞–ª–∏–∑—É–π—Ç–µ –∫–ª–∞—Å—Å WriteSpy. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–ª–∞—Å—Å –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ç—Ä–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ:

file1 ‚Äî —Ñ–∞–π–ª–æ–≤—ã–π –æ–±—ä–µ–∫—Ç
file2 ‚Äî —Ñ–∞–π–ª–æ–≤—ã–π –æ–±—ä–µ–∫—Ç
to_close ‚Äî –±—É–ª–µ–≤–æ –∑–Ω–∞—á–µ–Ω–∏–µ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞–≤–Ω—è–µ—Ç—Å—è False
–≠–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ WriteSpy –¥–æ–ª–∂–µ–Ω —è–≤–ª—è—Ç—å—Å—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–º –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏—é –∑–∞–ø–∏—Å–∏ —Å—Ä–∞–∑—É –≤ –æ–±–∞ —Ñ–∞–π–ª–æ–≤—ã—Ö
–æ–±—ä–µ–∫—Ç–∞ file1 –∏ file2. –ü–∞—Ä–∞–º–µ—Ç—Ä to_close –¥–æ–ª–∂–µ–Ω –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ñ–∞–π–ª–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ file1 –∏ file2 –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
–±–ª–æ–∫–∞ with. –ï—Å–ª–∏ –æ–Ω –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ True, –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –±–ª–æ–∫–∞ with –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –¥–æ–ª–∂–µ–Ω –∑–∞–∫—Ä—ã—Ç—å –æ–±–∞ —Ñ–∞–π–ª–æ–≤—ã—Ö
–æ–±—ä–µ–∫—Ç–∞, –µ—Å–ª–∏ False ‚Äî –æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã–º–∏.

–ö–ª–∞—Å—Å WriteSpy –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å —á–µ—Ç—ã—Ä–µ –º–µ—Ç–æ–¥–∞ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞:

write() ‚Äî –º–µ—Ç–æ–¥, –ø—Ä–∏–Ω–∏–º–∞—é—â–∏–π –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ —Ç–µ–∫—Å—Ç –∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—â–∏–π –µ–≥–æ –≤ –æ–±–∞ —Ñ–∞–π–ª–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–∞. –ï—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∏–∑
—Ñ–∞–π–ª–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –∑–∞–∫—Ä—ã—Ç –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∑–∞–ø–∏—Å–∏, –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤–æ–∑–±—É–∂–¥–µ–Ω–æ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ ValueError —Å —Ç–µ–∫—Å—Ç–æ–º:
–§–∞–π–ª –∑–∞–∫—Ä—ã—Ç –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∑–∞–ø–∏—Å–∏
close() ‚Äî –º–µ—Ç–æ–¥, –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–π –æ–±–∞ —Ñ–∞–π–ª–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–∞
writable() ‚Äî –º–µ—Ç–æ–¥, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π True, –µ—Å–ª–∏ –æ–±–∞ —Ñ–∞–π–ª–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–∞ –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –∑–∞–ø–∏—Å–∏, –∏–ª–∏ False –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ
closed() ‚Äî –º–µ—Ç–æ–¥, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π True, –µ—Å–ª–∏ –æ–±–∞ —Ñ–∞–π–ª–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–∞ –∑–∞–∫—Ä—ã—Ç—ã, –∏–ª–∏ False –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ
–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 1. –ù–∞–≥–ª—è–¥–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–ª–∞—Å—Å–∞ WriteSpy –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 2. –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–≥–æ, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ñ–∞–π–ª–æ–≤—ã–π –æ–±—ä–µ–∫—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–º –¥–ª—è –∑–∞–ø–∏—Å–∏, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ writable(). –î–∞–Ω–Ω—ã–π
–º–µ—Ç–æ–¥ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç True, –µ—Å–ª–∏ —Ñ–∞–π–ª–æ–≤—ã–π –æ–±—ä–µ–∫—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∑–∞–ø–∏—Å–∏, –∏–ª–∏ False –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ. –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø—Ä–∏–º–µ–Ω–∏—Ç—å
–º–µ—Ç–æ–¥ –Ω–∞ –∑–∞–∫—Ä—ã—Ç–æ–º —Ñ–∞–π–ª–æ–≤–æ–º –æ–±—ä–µ–∫—Ç–µ –±—É–¥–µ—Ç –≤–æ–∑–±—É–∂–¥–µ–Ω–æ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 3. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è. –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å
–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 4. –ö–ª–∞—Å—Å WriteSpy –¥–æ–ª–∂–µ–Ω —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª—É –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞, —Ç–æ –µ—Å—Ç—å –∏–º–µ—Ç—å –º–µ—Ç–æ–¥—ã __enter__() –∏
__exit__(). –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∂–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π."""


class WriteSpy:
    def __init__(self, file1, file2, to_close=False):
        self.file1, self.file2, self.to_close = file1, file2, to_close

    def __enter__(self):
        return self

    def __exit__(self, exc_type, exc_val, exc_tb):
        if self.to_close:
            self.file1.close()
            self.file2.close()

    def write(self, text):
        if not self.writable():
            raise ValueError('–§–∞–π–ª –∑–∞–∫—Ä—ã—Ç –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∑–∞–ø–∏—Å–∏')
        self.file1.write(text)
        self.file2.write(text)

    def close(self):
        self.file1.close()
        self.file2.close()

    def writable(self):
        if self.file1.closed or self.file2.closed:
            return False
        return self.file1.writable() and self.file2.writable()

    def closed(self):
        return self.file1.closed and self.file2.closed


# Sample
# Input
# 1:
#
# f1 = open('file1.txt', mode='w')
# f2 = open('file2.txt', mode='w')
#
# with WriteSpy(f1, f2, to_close=True) as combined:
#     combined.write('You shall seal the blinding light that plagues their dreams\n')
#     combined.write('You are the Vessel\n')
#     combined.write('You are the Hollow Knight')
#
# print(f1.closed, f2.closed)
#
# with open('file1.txt') as file1, open('file2.txt') as file2:
#     print(file1.read())
#     print(file2.read())
# Sample
# Output
# 1:
#
# True True
# You shall seal the blinding light that plagues their dreams
# You are the Vessel
# You are the Hollow Knight
# You shall seal the blinding light that plagues their dreams
# You are the Vessel
# You are the Hollow Knight
# Sample
# Input
# 2:
#
# f1 = open('file1.txt', mode='w')
# f2 = open('file2.txt', mode='w')
#
# with WriteSpy(f1, f2, to_close=True) as combined:
#     print(combined.writable())
#
# f1 = open('file1.txt')
# f2 = open('file2.txt')
#
# with WriteSpy(f1, f2, to_close=True) as combined:
#     print(combined.writable())
# Sample
# Output
# 2:
#
# True
# False
# Sample
# Input
# 3:
#
# f1 = open('file1.txt', mode='w')
# f2 = open('file2.txt', mode='w')
#
# with WriteSpy(f1, f2, to_close=True) as combined:
#     print(combined.closed())
#     f1.close()
#     print(combined.closed())
#     f2.close()
#     print(combined.closed())
# Sample
# Output
# 3:
#
# False
# False
# True