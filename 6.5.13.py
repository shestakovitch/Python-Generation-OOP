"""–ö–ª–∞—Å—Å Atomic üå∂Ô∏è
–†–µ–∞–ª–∏–∑—É–π—Ç–µ –∫–ª–∞—Å—Å Atomic. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–ª–∞—Å—Å –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–Ω–∏–º–∞—Ç—å –¥–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ:

data ‚Äî –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫, –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏–ª–∏ —Å–ª–æ–≤–∞—Ä—å
deep ‚Äî –±—É–ª–µ–≤–æ –∑–Ω–∞—á–µ–Ω–∏–µ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞–≤–Ω—è–µ—Ç—Å—è False
–≠–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ Atomic –¥–æ–ª–∂–µ–Ω —è–≤–ª—è—Ç—å—Å—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–º –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ –∫–æ–ª–ª–µ–∫—Ü–∏–µ–π data
–≤–Ω—É—Ç—Ä–∏ –±–ª–æ–∫–∞ with –≤ –∞—Ç–æ–º–∞—Ä–Ω–æ–º —Ä–µ–∂–∏–º–µ, —Ç–æ –µ—Å—Ç—å –ª–∏–±–æ –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω—ã, –ª–∏–±–æ –Ω–∏ –æ–¥–Ω–∞ –∏–∑ –Ω–∏—Ö. –ï—Å–ª–∏ –≤—Å–µ
–æ–ø–µ—Ä–∞—Ü–∏–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã (–Ω–µ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –≤–æ–∑–±—É–∂–¥–µ–Ω–∏—é –∏—Å–∫–ª—é—á–µ–Ω–∏—è), –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∫ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ data. –ï—Å–ª–∏ –∫–∞–∫–∞—è-–ª–∏–±–æ
–æ–ø–µ—Ä–∞—Ü–∏—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞, –≤—Å–µ —Ä–∞–Ω–µ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç–º–µ–Ω–µ–Ω—ã, –∞ –∫–æ–ª–ª–µ–∫—Ü–∏—è data –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∞ –≤
–∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.

–ü–∞—Ä–∞–º–µ—Ç—Ä deep –¥–æ–ª–∂–µ–Ω –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –∫–æ–ª–ª–µ–∫—Ü–∏–∏ data –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –±–ª–æ–∫–∞ with. –ï—Å–ª–∏ –æ–Ω –∏–º–µ–µ—Ç
–∑–Ω–∞—á–µ–Ω–∏–µ False, –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–æ–ª—å–∫–æ —Å–∞–º—É –∫–æ–ª–ª–µ–∫—Ü–∏—é data, –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—è –µ–µ
–≤–ª–æ–∂–µ–Ω–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ data —è–≤–ª—è–µ—Ç—Å—è –¥–≤—É–º–µ—Ä–Ω—ã–º —Å–ø–∏—Å–∫–æ–º –∏ –≤–Ω—É—Ç—Ä–∏ –±–ª–æ–∫–∞ with –ø—Ä–æ–∏–∑–æ—à–ª–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –∏–∑
–µ–≥–æ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤, —Ç–æ —ç—Ç–æ—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –¥–æ–ª–∂–µ–Ω —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–≤–æ–µ –Ω–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –¥–∞–∂–µ –µ—Å–ª–∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
–≤–Ω—É—Ç—Ä–∏ –±–ª–æ–∫–∞ with –ø—Ä–∏–≤–µ–¥—É—Ç –∫ –≤–æ–∑–±—É–∂–¥–µ–Ω–∏—é –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏ –≤–æ–∑–≤—Ä–∞—Ç—É –∫–æ–ª–ª–µ–∫—Ü–∏–∏ data –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ. –ï—Å–ª–∏ –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä
deep –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ True, –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–µ —Ç–æ–ª—å–∫–æ —Å–∞–º—É –∫–æ–ª–ª–µ–∫—Ü–∏—é data, –Ω–æ
–∏ –µ–µ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 1. –ù–∞–≥–ª—è–¥–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–ª–∞—Å—Å–∞ Atomic –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 2. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è. –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å
–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 3. –ö–ª–∞—Å—Å Atomic –¥–æ–ª–∂–µ–Ω —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª—É –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞, —Ç–æ –µ—Å—Ç—å –∏–º–µ—Ç—å –º–µ—Ç–æ–¥—ã __enter__() –∏
__exit__(). –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∂–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π."""


from copy import copy, deepcopy


class Atomic:
    def __init__(self, data, deep=False):
        self.data, self.deep = data, deep
        self.data_copy = deepcopy(self.data) if self.deep else copy(self.data)

    def __enter__(self):
        return self.data_copy

    def __exit__(self, exc_type, exc_val, exc_tb):
        if exc_type:
            return True
        if isinstance(self.data, list):
            self.data[:] = self.data_copy
        if isinstance(self.data, (set, dict)):
            self.data.clear()
            self.data.update(self.data_copy)
        return False


# Sample Input 1:
#
# numbers = [1, 2, 3, 4, 5]
#
# with Atomic(numbers) as atomic:
#     atomic.append(6)
#     atomic[2] = 0
#     del atomic[1]
#
# print(numbers)
# Sample Output 1:
#
# [1, 0, 4, 5, 6]
# Sample Input 2:
#
# numbers = [1, 2, 3, 4, 5]
#
# with Atomic(numbers) as atomic:
#     atomic.append(6)
#     atomic[2] = 0
#     del atomic[100]           # –æ–±—Ä–∞—â–µ–Ω–∏–µ –ø–æ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –∏–Ω–¥–µ–∫—Å—É
#
# print(numbers)
# Sample Output 2:
#
# [1, 2, 3, 4, 5]
# Sample Input 3:
#
# matrix = [[1, 2], [3, 4]]
#
# with Atomic(matrix) as atomic:
#     atomic[1].append(0)       # –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤–ª–æ–∂–µ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
#     atomic.append([5, 6])
#     del atomic[100]           # –æ–±—Ä–∞—â–µ–Ω–∏–µ –ø–æ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –∏–Ω–¥–µ–∫—Å—É
#
# print(matrix)
# Sample Output 3:
#
# [[1, 2], [3, 4, 0]]
# Sample Input 4:
#
# matrix = [[1, 2], [3, 4]]
#
# with Atomic(matrix, True) as atomic:
#     atomic[1].append(0)       # –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤–ª–æ–∂–µ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
#     atomic.append([5, 6])
#     del atomic[100]           # –æ–±—Ä–∞—â–µ–Ω–∏–µ –ø–æ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –∏–Ω–¥–µ–∫—Å—É
#
# print(matrix)
# Sample Output 4:
#
# [[1, 2], [3, 4]]